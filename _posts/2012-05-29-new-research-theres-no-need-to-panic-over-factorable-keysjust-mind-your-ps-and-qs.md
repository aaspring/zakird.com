---
layout: post
title: "Mining Your Ps and Qs: Detection of Widespread Weak Keys in Network Devices"
description: "RSA and DSA can fail catastrophically when used with
insufﬁcient entropy, but the extent to which these problems arise in practice outside of a handful of known bugs
has never been studied at Internet scale. To investigate the
extent of these problems, we perform the most comprehensive (to our knowledge) network survey of TLS and SSH
servers, collecting 5.8 million unique TLS certiﬁcates and
6.2 million unique SSH host keys. We ﬁnd that 0.75% of
the TLS certiﬁcates share keys due to insuficient entropy
during key generation, and we suspect that another 1.7%
come from the same faulty implementations and may be
susceptible to compromise. More surprisingly, we are
able to obtain RSA private keys for 0.50% of TLS hosts
and 0.03% of SSH hosts (because their public keys shared
nontrivial common factors due to entropy problems), and
DSA private keys for 1.6% of SSH hosts (because of insufﬁcient signature randomness at runtime)."
category: "research" 
tags: ["research", "security", "ssl"]
---
{% include JB/setup %}

You may have seen the preprint posted today by Lenstra et al. about entropy problems in public keys. [Nadia Heninger](http://cseweb.ucsd.edu/~naheninger/), [Eric Wustrow](https://ericw.us/trow/), [Alex Halderman](https://jhalderm.com), and I have been waiting to talk about some similar results. We will be publishing a full paper after the relevant manufacturers have been notified. Meanwhile, we’d like to give a more complete explanation of what’s really going on.

We have been able to remotely compromise about 0.4% of all the public keys used for SSL web site security. The keys we were able to compromise were generated incorrectly–using predictable “random” numbers that were sometimes repeated. There were two kinds of problems: keys that were generated with predictable randomness, and a subset of these, where the lack of randomness allows a remote attacker to efficiently factor the public key and obtain the private key. With the private key, an attacker can impersonate a web site or possibly decrypt encrypted traffic to that web site. We’ve developed a tool that can factor these keys and give us the private keys to all the hosts vulnerable to this attack on the Internet in only a few hours.

However, there’s no need to panic as this problem mainly affects various kinds of embedded devices such as routers and VPN devices, not full-blown web servers. (It’s certainly not, as suggested in the New York Times, any reason to have diminished confidence in the security of web-based commerce.) Unfortunately, we’ve found vulnerable devices from nearly every major manufacturer and we suspect that more than 200,000 devices, representing 4.1% of the SSL keys in our dataset, were generated with poor entropy. Any weak keys found to be generated by a device suggests that the entire class of devices may be vulnerable upon further analysis.
